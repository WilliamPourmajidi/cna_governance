# CNA Governance Platform Reference Architecture
[![arXiv](https://img.shields.io/badge/arXiv-2302.11617-b31b1b.svg)](https://arxiv.org/abs/2302.11617)
![python](https://img.shields.io/badge/python-3.11.0-blue.svg)

This repository contains a real-world implementation of a subset of the proposed Cloud-Native Application (CNA) Governance Platform reference architecture. This architecture is designed to manage, process, and archive telemetry data generated by CNAs deployed across multi-cloud environments, specifically on AWS and IBM.

As described in the paper (link to be provided), the reference architecture is divided into three distinct Resource Groups (RGs):
- **`RG-1`**: Responsible for initial telemetry ingestion and forwarding.
- **`RG-GOV-IMS`**: Manages telemetry data processing, conversion, and storage.
- **`RG-GOV-DA`**: Provides data analytics capabilities on archived telemetry data for monitoring and assessment.

The implementation in this repository includes a selection of components from these RGs, chosen to demonstrate core functionalities of the reference architecture. For a comprehensive understanding of the architecture, including the rationale for selecting specific components, implementation details, and data flow, please refer to the paper's sections on:
- **Subset Selection**: Justification for the components chosen in this implementation.
- **CNA Implementation**: Details on the CNAs used to generate and emit telemetry data into the governance architecture.

For the full technical description, please see the [paper on Arxiv](https://arxiv.org/abs/2302.11617).

## Project Structure

The project is organized into the following main folders:

- **`cna/`**: Contains the Cloud-Native Applications (CNAs) deployed on AWS and IBM. These CNAs generate telemetry data that is ingested by the governance platform.

- **`sample_cna_generated_data/`**: Contains sample telemetry (metrics and logs) generated by the AWS and IBM CNAs. This data is provided to illustrate the format and structure of the telemetry data handled by the platform.

- **`terraform/`**: Houses Terraform configurations for deploying the AWS infrastructure required for the governance platform. This includes API Gateway, SNS, SQS, S3 storage, and Lambda functions across two main resource groups, `AWS-RG-1` and `AWS-RG-GOV-IMS`.

- **`AWS-RG-GOV-DA/`**: Contains a sample analytics application that processes telemetry data stored in S3. This application calculates time delays across telemetry processing stages and provides statistical analysis.

## Folder Details

### `cna/`
- **`aws/`**: The AWS-specific Cloud-Native Application (CNA), which generates telemetry data and logs.
- **`ibm/`**: The IBM-specific Cloud-Native Application (CNA), which also generates telemetry data and logs.

Each CNA is containerized using Docker, with separate `README.md` files providing deployment instructions for AWS and IBM.

### `sample_cna_generated_data/`
- **`aws/immutable/`**: Contains immutable logs generated by the AWS CNA.
- **`aws/mutable/`**: Contains mutable telemetry data generated by the AWS CNA.
- **`ibm/immutable/`**: Contains immutable logs generated by the IBM CNA.
- **`ibm/mutable/`**: Contains mutable telemetry data generated by the IBM CNA.

Each file follows a standardized naming convention: `CSP-log_id.json`, where `CSP` is either `aws` or `ibm`.

### `terraform/`
This folder is divided into two main subfolders, each containing Terraform configurations for specific AWS resource groups:

- **`AWS-RG-1/`**:
    - Resources include an API Gateway, SQS queue, and associated Lambda functions for initial telemetry ingestion and forwarding.
    - Detailed setup and deployment instructions are available in the subfolder's `README.md`.

- **`AWS-RG-GOV-IMS/`**:
    - Resources include another API Gateway, SNS topics (Converter and Archiver), Lambda functions, and S3 storage (both mutable and immutable).
    - This group processes telemetry data further by converting and archiving it based on data type.

### `AWS-RG-GOV-DA/`
- Contains a data analytics application that loads telemetry data from the S3 buckets in `AWS-RG-GOV-IMS`, calculates processing delays across different stages, and provides a visual and statistical analysis.
- **Files**:
    - **`Dockerfile`**: Used to containerize the analytics application.
    - **`rg-gov-da-time-response-analysis.py`**: The main Python script for loading and processing telemetry data.
    - **`time_delay_plot.png`**: Visualization of time delays across telemetry processing stages.
    - **`time_diffs_observations.csv`** and **`time_diffs_statistics.csv`**: CSV files containing observations and statistical summaries of the telemetry processing delays.

## Prerequisites

To deploy and use this platform, ensure the following are installed and configured:

1. **Terraform**: For deploying AWS infrastructure.
2. **AWS CLI**: For managing AWS resources.
3. **Docker**: For containerizing and running the CNA and analytics applications.
4. **Python**: Required to verify dependencies and run the analytics application locally if needed.

## Deployment Instructions

1. **Deploy CNAs**: Follow the instructions in `cna/aws` and `cna/ibm` subfolders to deploy the CNAs on AWS and IBM.

2. **Deploy AWS Infrastructure**:
    - Navigate to the `terraform/AWS-RG-1` and `terraform/AWS-RG-GOV-IMS` folders.
    - Initialize and apply Terraform configurations in each folder:
      ```bash
      terraform init
      terraform apply
      ```

3. **Run Data Analytics Application**:
    - Navigate to `AWS-RG-GOV-DA`.
    - Build and run the Docker container following the `README.md` instructions in the `AWS-RG-GOV-DA` folder.
    - Alternatively, push the container image to AWS ECR and deploy it on AWS ECS.

## Notes

- **IAM Permissions**: Ensure that Lambda functions have the necessary IAM roles and policies for accessing AWS resources such as S3, SNS, and CloudWatch.
- **Testing**: Use the API Gateway endpoints to send telemetry data and check processing stages in SQS, SNS, and S3 to confirm end-to-end functionality.
- **Monitoring and Logging**: Logs are available in CloudWatch for Lambda functions, providing visibility into each stage of telemetry data processing.

 ## Citation

If you use or study the code, please cite it as follows.

```bibtex

@ARTICLE{pourmajidi2025reference,
  author={Pourmajidi, William and Zhang, Lei and Steinbacher, John and Erwin, Tony and Miranskyy, Andriy},
  journal={IEEE Transactions on Cloud Computing}, 
  title={A Reference Architecture for Governance of Cloud Native Applications}, 
  year={2025},
  volume={},
  number={},
  pages={1-18},
  doi={10.1109/TCC.2025.3578557},
  note={Early Access}
}

```
